25-02-26.21:53:02.966 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 22328 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:53:02.967 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:53:04.836 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:53:05.533 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:53:05.540 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:53:07.764 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.21:53:07.849 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 54893]
25-02-26.21:53:07.899 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.209 seconds (JVM running for 6.037)
25-02-26.21:53:08.076 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.21:53:08.096 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:53:08.247 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:53:08.366 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:53:08.376 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:53:08.412 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.21:53:08.530 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.21:53:08.541 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:53:08.541 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:53:08.889 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:53:08.890 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:53:08.892 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:53:08.892 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:54:26.990 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 6708 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:54:26.990 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:54:28.828 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:54:29.483 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:54:29.491 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:54:31.757 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.21:54:31.922 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#70805849:0/SimpleConnection@744db9fb [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55064]
25-02-26.21:54:31.976 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.264 seconds (JVM running for 6.213)
25-02-26.21:54:45.519 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:54:51.627 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.21:54:51.645 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:54:51.649 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:54:51.649 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:54:51.649 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:54:51.679 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:54:51.679 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:54:51.806 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:54:51.806 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:54:51.806 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:54:51.910 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.21:54:52.022 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.21:54:52.630 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:54:52.630 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:54:52.632 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:54:52.632 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:54:55.312 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 18820 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:54:55.312 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:54:56.925 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:54:57.563 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:54:57.571 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:54:59.756 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.21:54:59.834 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55215]
25-02-26.21:54:59.893 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 4.83 seconds (JVM running for 5.459)
25-02-26.21:55:00.003 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:55:00.028 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:55:00.033 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:55:00.033 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:55:00.055 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.21:55:00.057 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:55:00.177 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:55:00.177 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:55:00.177 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:55:00.268 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.21:55:00.374 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.21:55:00.383 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:55:00.384 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:55:00.878 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:55:00.881 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:55:00.883 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:55:00.883 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:56:08.459 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 2892 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:56:08.460 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:56:10.196 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:56:10.844 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:56:10.851 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:56:13.176 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.21:56:13.367 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#70805849:0/SimpleConnection@744db9fb [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55382]
25-02-26.21:56:13.423 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.248 seconds (JVM running for 6.004)
25-02-26.21:56:20.718 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:56:20.719 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.21:56:31.451 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:56:31.498 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:56:31.498 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:56:31.498 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:56:31.656 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:56:31.656 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:56:31.670 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:56:54.931 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:56:55.562 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:57:31.564 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:57:31.564 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=59s793ms649µs400ns).
25-02-26.21:57:31.564 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=59s807ms354µs600ns).
25-02-26.21:57:31.564 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=59s807ms491µs800ns).
25-02-26.21:57:31.572 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:58:08.787 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:58:08.789 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:58:35.132 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:58:35.132 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.21:58:35.136 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:58:35.169 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:58:35.170 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:58:35.235 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.21:58:36.136 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:58:36.136 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:58:36.138 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:58:36.138 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:58:39.286 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 5568 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:58:39.286 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:58:41.035 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:58:41.715 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:58:41.722 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:58:43.976 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.21:58:44.141 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#e7d0db2:0/SimpleConnection@31940d6b [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55598]
25-02-26.21:58:44.180 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.181 seconds (JVM running for 6.009)
25-02-26.21:58:44.340 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.21:58:44.366 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:58:44.508 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:59:01.667 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:59:07.230 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:59:07.230 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.21:59:07.230 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:59:07.242 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:59:07.246 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.21:59:14.993 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:59:19.299 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.21:59:51.680 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m3s70ms139µs800ns).
25-02-26.21:59:51.686 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.21:59:51.688 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.21:59:51.714 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:59:51.715 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.21:59:51.796 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.21:59:52.684 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:59:52.684 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.21:59:52.686 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:59:52.686 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.21:59:55.340 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 14468 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.21:59:55.341 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.21:59:57.197 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.21:59:57.909 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.21:59:57.917 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:00:00.247 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:00:00.312 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6b86826a:0/SimpleConnection@3fcc7f5c [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55767]
25-02-26.22:00:00.354 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.296 seconds (JVM running for 6.046)
25-02-26.22:00:00.498 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:00:00.520 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:00:00.659 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:00:05.921 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:00:51.491 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=45s569ms997µs400ns).
25-02-26.22:00:51.495 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:00:51.500 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:00:51.500 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:00:51.514 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:00:51.517 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:00:51.534 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:00:51.535 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:00:51.560 [main            ] ERROR RaffleStrategyController - 查询奖品列表失败 userId:xxx activityId:100301
25-02-26.22:00:51.682 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0001","info":"未知失败"}
25-02-26.22:00:52.494 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:00:52.494 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:00:52.496 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:00:52.496 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:00:55.208 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 4728 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:00:55.208 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.22:00:56.885 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:00:57.585 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:00:57.593 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:00:59.761 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:00:59.841 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55927]
25-02-26.22:00:59.902 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 4.947 seconds (JVM running for 5.578)
25-02-26.22:01:00.003 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:01:00.023 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:01:00.026 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:01:00.026 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:01:00.051 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:01:00.054 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:01:00.164 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:01:00.164 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:01:00.164 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:01:00.339 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置完成 userId:xxx activityId:100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:01:00.339 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:01:00.348 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:01:00.349 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:01:00.891 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:01:00.893 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:01:00.895 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:01:00.895 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:02:27.079 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 7116 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:02:27.080 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.22:02:28.982 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:02:29.678 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:02:29.686 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:02:31.883 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:02:31.926 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#357c9bd9:0/SimpleConnection@7530090a [delegate=amqp://guest@127.0.0.1:5672/, localPort= 56125]
25-02-26.22:02:31.977 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.152 seconds (JVM running for 5.809)
25-02-26.22:02:32.139 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:02:32.165 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:02:32.295 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:02:32.370 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:02:32.380 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:02:32.484 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置完成 userId:xxx activityId:100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:02:32.484 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:02:32.496 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:02:32.496 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:02:32.966 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:02:32.968 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:02:32.970 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:02:32.970 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:03:18.265 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 18828 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:03:18.266 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.22:03:19.985 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:03:20.634 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:03:20.641 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:03:22.882 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:03:22.960 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3c2dda7c:0/SimpleConnection@7512a9a6 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 56282]
25-02-26.22:03:23.012 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.024 seconds (JVM running for 5.809)
25-02-26.22:03:23.153 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:03:23.175 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:03:23.319 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:03:23.400 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:03:23.411 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:06.289 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m12s969ms517µs200ns).
25-02-26.22:05:06.289 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m12s876ms900µs399ns).
25-02-26.22:05:06.291 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:05:06.296 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:05:06.296 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:06.313 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:06.341 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:06.342 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:06.435 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置完成 userId:xxx activityId:100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:05:06.436 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":1},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":2}],"info":"成功"}
25-02-26.22:05:07.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:07.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:07.294 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:05:07.294 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:05:09.951 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 20716 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:05:09.951 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.22:05:11.623 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_202 on X with PID 14784 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:05:11.623 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-02-26.22:05:12.008 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:05:12.710 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:05:12.719 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:05:13.511 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:05:14.394 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:05:14.412 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:05:15.470 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:05:15.520 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6b86826a:0/SimpleConnection@7512a9a6 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 56557]
25-02-26.22:05:15.584 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 5.955 seconds (JVM running for 6.694)
25-02-26.22:05:15.721 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:05:15.742 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:15.878 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:15.969 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:15.986 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:17.345 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:05:17.429 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 56561]
25-02-26.22:05:17.487 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 6.121 seconds (JVM running for 6.8)
25-02-26.22:05:17.632 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置开始 userId:xxx activityId:100301
25-02-26.22:05:17.653 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:17.785 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:17.859 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:17.870 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:17.978 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置完成 userId:xxx activityId:100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":1}],"info":"成功"}
25-02-26.22:05:17.979 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":1}],"info":"成功"}
25-02-26.22:05:18.000 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:18.001 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:18.473 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:18.476 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:18.477 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:05:18.478 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:05:19.313 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:19.315 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:05:19.668 [main            ] INFO  RaffleStrategyController - 查询奖品列表配置完成 userId:xxx activityId:100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":1}],"info":"成功"}
25-02-26.22:05:19.668 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnlockCount":0},{"awardId":106,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":false,"sort":6,"waitUnlockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":false,"sort":8,"waitUnlockCount":1}],"info":"成功"}
25-02-26.22:05:20.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:05:20.004 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:05:20.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:05:20.017 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:05:20.259 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:20.259 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:05:20.260 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:05:20.261 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:34:10.443 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 11436 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:34:10.444 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:34:12.169 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:34:12.923 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:34:12.934 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:34:15.610 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:34:15.653 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 57820]
25-02-26.22:34:15.699 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.506 seconds (JVM running for 6.126)
25-02-26.22:34:15.850 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 activityId:100301
25-02-26.22:34:15.867 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:34:15.989 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:34:16.100 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，完成 activityId:100301
25-02-26.22:34:16.192 [main            ] INFO  RaffleActivityControllerTest - 测试结果： {"code":"0000","data":true,"info":"成功"}
25-02-26.22:34:16.204 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:34:16.205 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:34:16.690 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:34:16.693 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:34:16.695 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:34:16.695 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:36:22.986 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 12236 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:36:22.987 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:36:24.649 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:36:25.334 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:36:25.342 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:36:27.398 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:36:27.458 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 57990]
25-02-26.22:36:27.569 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.838 seconds (JVM running for 5.477)
25-02-26.22:36:27.693 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:36:27.750 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:36:27.872 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:36:27.936 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:36:27.947 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: null
25-02-26.22:36:27.947 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 null rule_default
25-02-26.22:36:27.949 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:36:27.959 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:36:28.051 [main            ] INFO  StrategyRepository     - tree_node_line 转为 Map ：{}
25-02-26.22:36:28.051 [main            ] INFO  StrategyRepository     - tree_node 转为 Map ：{}
25-02-26.22:36:28.054 [main            ] ERROR RaffleActivityController - 活动抽奖失败 userId:xxx activityId:100301
java.lang.NullPointerException: null
	at org.example.infrastructure.persistent.repository.StrategyRepository.queryRuleTreeVoByTreeId(StrategyRepository.java:231)
	at org.example.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$19908ba7.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$21ee6253.queryRuleTreeVoByTreeId(<generated>)
	at org.example.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicTree(DefaultRaffleStrategy.java:152)
	at org.example.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:64)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:125)
	at org.example.test.trigger.RaffleActivityControllerTest.test_draw(RaffleActivityControllerTest.java:42)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
25-02-26.22:36:28.065 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:36:28.067 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0001","info":"未知失败"}
25-02-26.22:36:28.077 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:36:28.078 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:36:28.528 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:36:28.562 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:36:28.565 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:36:28.565 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:37:02.874 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 20688 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:37:02.875 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:37:04.516 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:37:05.177 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:05.184 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:07.246 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:37:07.295 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58114]
25-02-26.22:37:07.345 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.722 seconds (JVM running for 5.325)
25-02-26.22:37:07.493 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:37:07.556 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:07.686 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:07.785 [main            ] INFO  AbstractRaffleActivityPartake - 创建参与活动订单[已存在未消费] userId:xxx activityId:100301 userRaffleOrderEntity:{"activityId":100301,"activityName":"测试活动","orderId":"409987497930","orderState":"create","orderTime":1740580588000,"strategyId":100006,"userId":"xxx"}
25-02-26.22:37:07.786 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:37:07.799 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 104
25-02-26.22:37:07.800 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 104 rule_default
25-02-26.22:37:07.800 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:07.810 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:07.831 [main            ] INFO  StrategyRepository     - tree_node_line 转为 Map ：{"rule_stock":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_luck_award"}]}
25-02-26.22:37:07.834 [main            ] INFO  StrategyRepository     - tree_node 转为 Map ：{"rule_stock":{"ruleDesc":"库存扣减规则","ruleKey":"rule_stock","treeId":"tree_luck_award","treeNodeLineVoList":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_luck_award"}]},"rule_luck_award":{"ruleDesc":"兜底奖品随机积分","ruleKey":"rule_luck_award","ruleValue":"101:1,100","treeId":"tree_luck_award"}}
25-02-26.22:37:07.836 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:104
25-02-26.22:37:07.854 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:37:07.855 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 104 
25-02-26.22:37:07.891 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xxx"},"id":"08231408507","timestamp":1740580627861}
25-02-26.22:37:07.898 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":104,"awardTitle":"5等奖","userId":"xxx"},"id":"08231408507","timestamp":1740580627861}
25-02-26.22:37:07.901 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:37:07.903 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":104,"awardIndex":4,"awardTitle":"5等奖"},"info":"成功"}
25-02-26.22:37:07.923 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:37:07.924 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:37:08.334 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:37:08.900 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:37:08.902 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:37:08.902 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:37:23.038 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 10876 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:37:23.038 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:37:24.816 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:37:25.526 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:25.533 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:28.010 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:37:28.068 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6d80e411:0/SimpleConnection@169d1f92 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58244]
25-02-26.22:37:28.161 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.423 seconds (JVM running for 6.187)
25-02-26.22:37:28.315 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:37:38.153 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:37:38.533 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:37:38.536 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:38.536 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:42.697 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:37:45.502 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:37:48.904 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:37:48.931 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:37:48.932 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:37:49.025 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:49.025 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:49.084 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:37:49.094 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 105
25-02-26.22:37:49.094 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 105 rule_default
25-02-26.22:37:49.095 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:49.104 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:49.111 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:105
25-02-26.22:37:49.128 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:37:49.129 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 105 
25-02-26.22:37:49.274 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xxx"},"id":"48473857359","timestamp":1740580669140}
25-02-26.22:37:49.290 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:37:49.292 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":105,"awardIndex":5,"awardTitle":"4等奖"},"info":"成功"}
25-02-26.22:37:49.907 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:37:49.907 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:37:49.910 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:37:49.910 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:37:52.632 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 15624 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:37:52.633 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:37:54.413 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:37:55.101 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:55.110 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:37:57.581 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:37:57.638 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#40dee07b:0/SimpleConnection@18a38bba [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58383]
25-02-26.22:37:57.713 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xxx"},"id":"48473857359","timestamp":1740580669140}
25-02-26.22:37:57.716 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.367 seconds (JVM running for 6.123)
25-02-26.22:37:57.873 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:37:57.940 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:58.080 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:37:58.126 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:37:58.137 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 106
25-02-26.22:37:58.137 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 106 rule_default
25-02-26.22:37:58.139 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:37:58.149 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:38:09.854 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:09.858 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:38:09.860 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:09.861 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:104
25-02-26.22:38:10.258 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:38:10.261 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:22.718 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:24.238 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:26.260 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:29.555 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:38:29.555 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:38:29.632 [main            ] INFO  StrategyRepository     - tree_node_line 转为 Map ：{"rule_lock":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_stock","treeId":"tree_lock_1"},{"ruleLimitType":"EQUAL","ruleLimitValue":"TAKE_OVER","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_1"}],"rule_stock":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_1"}]}
25-02-26.22:38:29.636 [main            ] INFO  StrategyRepository     - tree_node 转为 Map ：{"rule_lock":{"ruleDesc":"限定用户已完成N次抽奖后解锁","ruleKey":"rule_lock","ruleValue":"1","treeId":"tree_lock_1","treeNodeLineVoList":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_stock","treeId":"tree_lock_1"},{"ruleLimitType":"EQUAL","ruleLimitValue":"TAKE_OVER","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_1"}]},"rule_stock":{"ruleDesc":"库存扣减规则","ruleKey":"rule_stock","treeId":"tree_lock_1","treeNodeLineVoList":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_1"}]},"rule_luck_award":{"ruleDesc":"兜底奖品随机积分","ruleKey":"rule_luck_award","ruleValue":"101:1,100","treeId":"tree_lock_1"}}
25-02-26.22:38:29.640 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤 - 次数锁 userId:xxx strategyId:100006 awardId:106
25-02-26.22:38:29.644 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤 - 次数锁[放行] userId:xxx strategyId:100006 awardId:106 raffleCount:1 userRaffleCount:4
25-02-26.22:38:29.644 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】 treeId:tree_lock_1 node:rule_lock code:0000
25-02-26.22:38:29.646 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:106
25-02-26.22:38:29.661 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】 treeId:tree_lock_1 node:rule_stock code:0001
25-02-26.22:38:29.661 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 106 
25-02-26.22:38:29.694 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":106,"awardTitle":"3等奖","userId":"xxx"},"id":"38918351742","timestamp":1740580709667}
25-02-26.22:38:29.713 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:38:29.714 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":106,"awardIndex":6,"awardTitle":"3等奖"},"info":"成功"}
25-02-26.22:38:30.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:30.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:105
25-02-26.22:38:30.023 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:30.522 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:38:30.522 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:38:30.524 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:38:30.524 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:38:33.388 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 11112 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:38:33.388 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:38:35.159 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:38:35.846 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:38:35.852 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:38:38.165 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:38:38.226 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#cfacf0:0/SimpleConnection@28b68067 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58527]
25-02-26.22:38:38.334 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":106,"awardTitle":"3等奖","userId":"xxx"},"id":"38918351742","timestamp":1740580709667}
25-02-26.22:38:38.337 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.22 seconds (JVM running for 5.936)
25-02-26.22:38:38.493 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:38:38.570 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:38:38.706 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:38:38.755 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:38:38.768 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 108
25-02-26.22:38:38.768 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 108 rule_default
25-02-26.22:38:38.769 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:38:38.779 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:38:48.459 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:48.464 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:48.469 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:38:49.050 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:38:50.514 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:38:51.243 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:55.094 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:38:56.464 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:39:00.561 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:39:00.852 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:39:03.040 [main            ] INFO  StrategyRepository     - tree_node_line 转为 Map ：{"rule_lock":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_stock","treeId":"tree_lock_2"},{"ruleLimitType":"EQUAL","ruleLimitValue":"TAKE_OVER","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_2"}],"rule_stock":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_2"}]}
25-02-26.22:39:41.407 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=52s947ms917µs800ns).
25-02-26.22:39:41.407 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=52s948ms775µs100ns).
25-02-26.22:39:41.407 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=51s606ms114µs).
25-02-26.22:39:41.407 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:39:41.413 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:39:41.416 [main            ] INFO  StrategyRepository     - tree_node 转为 Map ：{"rule_lock":{"ruleDesc":"限定用户已完成N次抽奖后解锁","ruleKey":"rule_lock","ruleValue":"2","treeId":"tree_lock_2","treeNodeLineVoList":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_stock","treeId":"tree_lock_2"},{"ruleLimitType":"EQUAL","ruleLimitValue":"TAKE_OVER","ruleNodeFrom":"rule_lock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_2"}]},"rule_stock":{"ruleDesc":"库存扣减规则","ruleKey":"rule_stock","treeId":"tree_lock_2","treeNodeLineVoList":[{"ruleLimitType":"EQUAL","ruleLimitValue":"ALLOW","ruleNodeFrom":"rule_stock","ruleNodeTo":"rule_luck_award","treeId":"tree_lock_2"}]},"rule_luck_award":{"ruleDesc":"兜底奖品随机积分","ruleKey":"rule_luck_award","ruleValue":"101:1,100","treeId":"tree_lock_2"}}
25-02-26.22:39:41.419 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤 - 次数锁 userId:xxx strategyId:100006 awardId:108
25-02-26.22:39:41.422 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤 - 次数锁[放行] userId:xxx strategyId:100006 awardId:108 raffleCount:2 userRaffleCount:5
25-02-26.22:39:41.423 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】 treeId:tree_lock_2 node:rule_lock code:0000
25-02-26.22:39:41.423 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:108
25-02-26.22:39:41.436 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:39:41.437 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:39:41.440 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】 treeId:tree_lock_2 node:rule_stock code:0001
25-02-26.22:39:41.440 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 108 
25-02-26.22:39:41.468 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xxx"},"id":"80199915703","timestamp":1740580781446}
25-02-26.22:39:41.477 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:39:41.478 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":108,"awardIndex":8,"awardTitle":"1等奖"},"info":"成功"}
25-02-26.22:39:42.422 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:39:42.422 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:39:42.424 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:39:42.424 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:39:45.450 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 22148 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:39:45.450 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:39:47.209 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:39:47.911 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:39:47.926 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:39:50.182 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:39:50.286 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c5a2d5:0/SimpleConnection@4a14f7d7 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58697]
25-02-26.22:39:50.328 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":108,"awardTitle":"1等奖","userId":"xxx"},"id":"80199915703","timestamp":1740580781446}
25-02-26.22:39:50.330 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 5.144 seconds (JVM running for 5.981)
25-02-26.22:39:50.463 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:39:50.537 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:39:50.672 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:39:50.718 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:39:50.730 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 103
25-02-26.22:39:50.731 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 103 rule_default
25-02-26.22:39:50.732 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:39:50.742 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:39:50.747 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:103
25-02-26.22:39:50.764 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:39:50.764 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 103 
25-02-26.22:39:50.887 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xxx"},"id":"29867086419","timestamp":1740580790770}
25-02-26.22:39:50.887 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":103,"awardTitle":"6等奖","userId":"xxx"},"id":"29867086419","timestamp":1740580790770}
25-02-26.22:39:50.896 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:39:50.899 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":103,"awardIndex":3,"awardTitle":"6等奖"},"info":"成功"}
25-02-26.22:39:50.908 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:39:50.908 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:39:51.325 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:39:51.898 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:39:51.899 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:39:51.900 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:39:59.119 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 696 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:39:59.120 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:40:00.705 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:40:01.403 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:01.410 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:03.419 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:40:03.457 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58803]
25-02-26.22:40:03.532 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.642 seconds (JVM running for 5.265)
25-02-26.22:40:03.659 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:40:03.725 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:03.849 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:03.889 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:40:03.902 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 102
25-02-26.22:40:03.902 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 102 rule_default
25-02-26.22:40:03.903 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:03.913 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:03.917 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:102
25-02-26.22:40:03.934 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:40:03.935 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 102 
25-02-26.22:40:04.043 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xxx"},"id":"77682884323","timestamp":1740580803940}
25-02-26.22:40:04.053 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:40:04.055 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":102,"awardIndex":2,"awardTitle":"7等奖"},"info":"成功"}
25-02-26.22:40:04.056 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xxx"},"id":"77682884323","timestamp":1740580803940}
25-02-26.22:40:04.064 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:04.066 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:04.522 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:05.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:40:05.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:40:05.011 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:05.011 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:106
25-02-26.22:40:05.021 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:05.069 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:05.071 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:05.071 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:08.849 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 13584 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:40:08.850 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:40:10.496 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:40:11.162 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:11.169 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:13.191 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:40:13.230 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58910]
25-02-26.22:40:13.291 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.682 seconds (JVM running for 5.297)
25-02-26.22:40:13.417 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:40:13.475 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:13.594 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:13.633 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:40:13.646 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 102
25-02-26.22:40:13.646 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 102 rule_default
25-02-26.22:40:13.647 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:13.657 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:13.662 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:102
25-02-26.22:40:13.680 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:40:13.680 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 102 
25-02-26.22:40:13.787 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xxx"},"id":"73148193204","timestamp":1740580813684}
25-02-26.22:40:13.793 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":102,"awardTitle":"7等奖","userId":"xxx"},"id":"73148193204","timestamp":1740580813684}
25-02-26.22:40:13.797 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:40:13.799 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":102,"awardIndex":2,"awardTitle":"7等奖"},"info":"成功"}
25-02-26.22:40:13.822 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:13.823 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:14.299 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:14.795 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:14.798 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:14.798 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:44.652 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 17768 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:40:44.653 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:40:46.244 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:40:46.944 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:46.952 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:48.930 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:40:48.967 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#c412556:0/SimpleConnection@205159dc [delegate=amqp://guest@127.0.0.1:5672/, localPort= 59038]
25-02-26.22:40:49.018 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.61 seconds (JVM running for 5.191)
25-02-26.22:40:49.172 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:40:49.233 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:49.350 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:49.391 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:40:49.402 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: 105
25-02-26.22:40:49.403 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 105 rule_default
25-02-26.22:40:49.403 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:49.415 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:49.420 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:xxx strategyId:100006 awardId:105
25-02-26.22:40:49.435 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】 treeId:tree_luck_award node:rule_stock code:0001
25-02-26.22:40:49.436 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 xxx 100006 105 
25-02-26.22:40:49.539 [main            ] INFO  EventPublisher         - 发送MQ消息, topic:send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xxx"},"id":"91192066979","timestamp":1740580849439}
25-02-26.22:40:49.544 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":105,"awardTitle":"4等奖","userId":"xxx"},"id":"91192066979","timestamp":1740580849439}
25-02-26.22:40:49.548 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:40:49.549 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0000","data":{"awardId":105,"awardIndex":5,"awardTitle":"4等奖"},"info":"成功"}
25-02-26.22:40:49.559 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:49.560 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:50.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延时队列获取，降低对数据库的更新频次，不要产生竞争】
25-02-26.22:40:50.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不会产生竞争】
25-02-26.22:40:50.010 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:50.012 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存 strategyId:100006 awardId:108
25-02-26.22:40:50.012 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:50.022 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:50.553 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:50.556 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:50.556 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:54.208 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_202 on X with PID 28468 (started by 12135 in D:\JavaStudy\big-market\big-market-app)
25-02-26.22:40:54.208 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-02-26.22:40:55.833 [main            ] INFO  Version                - Redisson 3.23.4
25-02-26.22:40:56.509 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:56.517 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 127.0.0.1/127.0.0.1:6379
25-02-26.22:40:58.579 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [127.0.0.1:5672]
25-02-26.22:40:58.640 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#357c9bd9:0/SimpleConnection@7530090a [delegate=amqp://guest@127.0.0.1:5672/, localPort= 59167]
25-02-26.22:40:58.712 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 4.735 seconds (JVM running for 5.302)
25-02-26.22:40:58.839 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 userId:xxx activityId:100301
25-02-26.22:40:58.903 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:59.020 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:59.062 [main            ] INFO  RaffleActivityController - 抽奖活动，创建订单 userId：xxx activityId：100301 orderId：100301
25-02-26.22:40:59.074 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId：xxx strategyId: 100006 ruleModel: rule_default awardId: null
25-02-26.22:40:59.074 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 xxx 100006 null rule_default
25-02-26.22:40:59.074 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-02-26.22:40:59.085 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-02-26.22:40:59.169 [main            ] INFO  StrategyRepository     - tree_node_line 转为 Map ：{}
25-02-26.22:40:59.169 [main            ] INFO  StrategyRepository     - tree_node 转为 Map ：{}
25-02-26.22:40:59.172 [main            ] ERROR RaffleActivityController - 活动抽奖失败 userId:xxx activityId:100301
java.lang.NullPointerException: null
	at org.example.infrastructure.persistent.repository.StrategyRepository.queryRuleTreeVoByTreeId(StrategyRepository.java:231)
	at org.example.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$19908ba7.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at org.example.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$2e2c7140.queryRuleTreeVoByTreeId(<generated>)
	at org.example.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicTree(DefaultRaffleStrategy.java:152)
	at org.example.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:64)
	at org.example.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:125)
	at org.example.test.trigger.RaffleActivityControllerTest.test_draw(RaffleActivityControllerTest.java:42)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
25-02-26.22:40:59.183 [main            ] INFO  RaffleActivityControllerTest - 请求参数:{"activityId":100301,"userId":"xxx"}
25-02-26.22:40:59.185 [main            ] INFO  RaffleActivityControllerTest - 测试结果:{"code":"0001","info":"未知失败"}
25-02-26.22:40:59.195 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:59.196 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-02-26.22:40:59.697 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:59.707 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-02-26.22:40:59.709 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-02-26.22:40:59.710 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
